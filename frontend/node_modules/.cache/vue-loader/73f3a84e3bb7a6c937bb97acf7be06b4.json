{"remainingRequest":"/Users/tbw/work/btProject/reaction-cut/frontend/node_modules/.pnpm/vue-loader@15.11.1_@vue+compiler-sfc@3.5.22_cache-loader@4.1.0_webpack@4.47.0__css-load_f9e102e5cbb5fa5aa7d45569a28cebe6/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/tbw/work/btProject/reaction-cut/frontend/src/components/QRCodeTest.vue?vue&type=script&lang=js","dependencies":[{"path":"/Users/tbw/work/btProject/reaction-cut/frontend/src/components/QRCodeTest.vue","mtime":1761575496817},{"path":"/Users/tbw/work/btProject/reaction-cut/frontend/node_modules/.pnpm/cache-loader@4.1.0_webpack@4.47.0/node_modules/cache-loader/dist/cjs.js","mtime":1761026713270},{"path":"/Users/tbw/work/btProject/reaction-cut/frontend/node_modules/.pnpm/babel-loader@8.4.1_@babel+core@7.28.5_webpack@4.47.0/node_modules/babel-loader/lib/index.js","mtime":1761026722096},{"path":"/Users/tbw/work/btProject/reaction-cut/frontend/node_modules/.pnpm/cache-loader@4.1.0_webpack@4.47.0/node_modules/cache-loader/dist/cjs.js","mtime":1761026713270},{"path":"/Users/tbw/work/btProject/reaction-cut/frontend/node_modules/.pnpm/vue-loader@15.11.1_@vue+compiler-sfc@3.5.22_cache-loader@4.1.0_webpack@4.47.0__css-load_f9e102e5cbb5fa5aa7d45569a28cebe6/node_modules/vue-loader/lib/index.js","mtime":1761026704427}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CmltcG9ydCBxcmNvZGUgZnJvbSAncXJjb2RlLWdlbmVyYXRvcicKaW1wb3J0IHsgZ2VuZXJhdGVRUkNvZGUgfSBmcm9tICdAL2FwaS9iaWxpYmlsaUF1dGgnCgpleHBvcnQgZGVmYXVsdCB7CiAgbmFtZTogJ1FSQ29kZVRlc3QnLAogIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICBsb2FkaW5nOiBmYWxzZSwKICAgICAgdGVzdFJlc3VsdDogbnVsbCwKICAgICAgcXJDb2RlVXJsOiAnJywKICAgICAgZXJyb3JNZXNzYWdlOiAnJwogICAgfQogIH0sCiAgbWV0aG9kczogewogICAgYXN5bmMgdGVzdFFSQ29kZUdlbmVyYXRpb24oKSB7CiAgICAgIHRoaXMubG9hZGluZyA9IHRydWUKICAgICAgdGhpcy50ZXN0UmVzdWx0ID0gbnVsbAogICAgICB0aGlzLnFyQ29kZVVybCA9ICcnCiAgICAgIHRoaXMuZXJyb3JNZXNzYWdlID0gJycKICAgICAgCiAgICAgIHRyeSB7CiAgICAgICAgY29uc29sZS5sb2coJ+W8gOWni+a1i+ivleS6jOe7tOeggeeUn+aIkC4uLicpCiAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBnZW5lcmF0ZVFSQ29kZSgpCiAgICAgICAgY29uc29sZS5sb2coJ+S6jOe7tOeggeeUn+aIkOWTjeW6lDonLCByZXNwb25zZSkKICAgICAgICAKICAgICAgICB0aGlzLnRlc3RSZXN1bHQgPSByZXNwb25zZQogICAgICAgIAogICAgICAgIGlmIChyZXNwb25zZS5jb2RlID09PSAwKSB7CiAgICAgICAgICB0aGlzLnFyQ29kZVVybCA9IHJlc3BvbnNlLmRhdGEudXJsCiAgICAgICAgICBjb25zb2xlLmxvZygn5LqM57u056CBVVJMOicsIHRoaXMucXJDb2RlVXJsKQogICAgICAgICAgCiAgICAgICAgICAvLyDnrYnlvoVET03mm7TmlrAKICAgICAgICAgIGF3YWl0IHRoaXMuJG5leHRUaWNrKCkKICAgICAgICAgIGNvbnNvbGUubG9nKCdET03lt7Lmm7TmlrDvvIzlh4blpIfnlJ/miJDkuoznu7TnoIEnKQogICAgICAgICAgCiAgICAgICAgICAvLyDnlJ/miJDkuoznu7TnoIEKICAgICAgICAgIGF3YWl0IHRoaXMuZ2VuZXJhdGVUZXN0UVJDb2RlKCkKICAgICAgICB9IGVsc2UgewogICAgICAgICAgdGhpcy5lcnJvck1lc3NhZ2UgPSAnQVBJ6L+U5Zue6ZSZ6K+vOiAnICsgcmVzcG9uc2UubWVzc2FnZQogICAgICAgIH0KICAgICAgfSBjYXRjaCAoZXJyb3IpIHsKICAgICAgICBjb25zb2xlLmVycm9yKCfmtYvor5Xkuoznu7TnoIHnlJ/miJDlpLHotKU6JywgZXJyb3IpCiAgICAgICAgdGhpcy5lcnJvck1lc3NhZ2UgPSAn5rWL6K+V5aSx6LSlOiAnICsgZXJyb3IubWVzc2FnZQogICAgICB9IGZpbmFsbHkgewogICAgICAgIHRoaXMubG9hZGluZyA9IGZhbHNlCiAgICAgIH0KICAgIH0sCiAgICAKICAgIGFzeW5jIHRlc3RXaXRoU2FtcGxlRGF0YSgpIHsKICAgICAgdGhpcy50ZXN0UmVzdWx0ID0gewogICAgICAgIGNvZGU6IDAsCiAgICAgICAgbWVzc2FnZTogInN1Y2Nlc3MiLAogICAgICAgIGRhdGE6IHsKICAgICAgICAgIHVybDogImh0dHBzOi8vcGFzc3BvcnQuYmlsaWJpbGkuY29tL2g1LWFwcC9wYXNzcG9ydC9sb2dpbi9xcj9vYXV0aEtleT1zYW1wbGVfa2V5XzEyMzQ1NiIsCiAgICAgICAgICBxcmNvZGVfa2V5OiAic2FtcGxlX2tleV8xMjM0NTYiCiAgICAgICAgfQogICAgICB9CiAgICAgIAogICAgICB0aGlzLnFyQ29kZVVybCA9IHRoaXMudGVzdFJlc3VsdC5kYXRhLnVybAogICAgICB0aGlzLmVycm9yTWVzc2FnZSA9ICcnCiAgICAgIAogICAgICAvLyDnrYnlvoVET03mm7TmlrAKICAgICAgYXdhaXQgdGhpcy4kbmV4dFRpY2soKQogICAgICBjb25zb2xlLmxvZygnRE9N5bey5pu05paw77yM5YeG5aSH55Sf5oiQ5LqM57u056CBJykKICAgICAgCiAgICAgIC8vIOeUn+aIkOS6jOe7tOeggQogICAgICBhd2FpdCB0aGlzLmdlbmVyYXRlVGVzdFFSQ29kZSgpCiAgICB9LAogICAgCiAgICBnZW5lcmF0ZVRlc3RRUkNvZGUoKSB7CiAgICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7CiAgICAgICAgaWYgKCF0aGlzLnFyQ29kZVVybCkgewogICAgICAgICAgY29uc3QgZXJyb3IgPSBuZXcgRXJyb3IoJ+S6jOe7tOeggVVSTOS4uuepuicpCiAgICAgICAgICBjb25zb2xlLndhcm4oJ+e8uuWwkeeUn+aIkOS6jOe7tOeggeeahOW/heimgeWPguaVsDog5LqM57u056CBVVJM5Li656m6JykKICAgICAgICAgIHRoaXMuZXJyb3JNZXNzYWdlID0gJ+S6jOe7tOeggVVSTOS4uuepuicKICAgICAgICAgIHJlamVjdChlcnJvcikKICAgICAgICAgIHJldHVybgogICAgICAgIH0KICAgICAgICAKICAgICAgICBpZiAoIXRoaXMuJHJlZnMudGVzdFFSQ29kZUNhbnZhcykgewogICAgICAgICAgY29uc3QgZXJyb3IgPSBuZXcgRXJyb3IoJ+S6jOe7tOeggUNhbnZhc+WuueWZqOacquaJvuWIsCcpCiAgICAgICAgICBjb25zb2xlLndhcm4oJ+e8uuWwkeeUn+aIkOS6jOe7tOeggeeahOW/heimgeWPguaVsDog5LqM57u056CBQ2FudmFz5a655Zmo5pyq5om+5YiwJykKICAgICAgICAgIHRoaXMuZXJyb3JNZXNzYWdlID0gJ+S6jOe7tOeggeaYvuekuuWuueWZqOacquaJvuWIsCcKICAgICAgICAgIHJlamVjdChlcnJvcikKICAgICAgICAgIHJldHVybgogICAgICAgIH0KICAgICAgICAKICAgICAgICB0cnkgewogICAgICAgICAgY29uc29sZS5sb2coJ+W8gOWni+S9v+eUqHFyY29kZS1nZW5lcmF0b3LnlJ/miJDmtYvor5Xkuoznu7TnoIE6JywgeyB1cmw6IHRoaXMucXJDb2RlVXJsLCBjYW52YXM6IHRoaXMuJHJlZnMudGVzdFFSQ29kZUNhbnZhcyB9KQogICAgICAgICAgCiAgICAgICAgICAvLyDmuIXnqbrlrrnlmagKICAgICAgICAgIHRoaXMuJHJlZnMudGVzdFFSQ29kZUNhbnZhcy5pbm5lckhUTUwgPSAnJwogICAgICAgICAgCiAgICAgICAgICAvLyDkvb/nlKhxcmNvZGUtZ2VuZXJhdG9y55Sf5oiQ5LqM57u056CBCiAgICAgICAgICBjb25zdCBxciA9IHFyY29kZSgwLCAnTScpCiAgICAgICAgICBxci5hZGREYXRhKHRoaXMucXJDb2RlVXJsKQogICAgICAgICAgcXIubWFrZSgpCiAgICAgICAgICAKICAgICAgICAgIC8vIOWIm+W7umNhbnZhc+WFg+e0oAogICAgICAgICAgY29uc3QgY2FudmFzID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnY2FudmFzJykKICAgICAgICAgIGNhbnZhcy53aWR0aCA9IDMwMAogICAgICAgICAgY2FudmFzLmhlaWdodCA9IDMwMAogICAgICAgICAgY2FudmFzLnN0eWxlLm1heFdpZHRoID0gJzEwMCUnCiAgICAgICAgICBjYW52YXMuc3R5bGUubWF4SGVpZ2h0ID0gJzEwMCUnCiAgICAgICAgICAKICAgICAgICAgIC8vIOiOt+WPlmNhbnZhc+S4iuS4i+aWh+W5tue7mOWItuS6jOe7tOeggQogICAgICAgICAgY29uc3QgY3R4ID0gY2FudmFzLmdldENvbnRleHQoJzJkJykKICAgICAgICAgIGNvbnN0IGNlbGxTaXplID0gTWF0aC5mbG9vcihjYW52YXMud2lkdGggLyBxci5nZXRNb2R1bGVDb3VudCgpKQogICAgICAgICAgCiAgICAgICAgICAvLyDnu5jliLbog4zmma8KICAgICAgICAgIGN0eC5maWxsU3R5bGUgPSAnI2ZmZmZmZicKICAgICAgICAgIGN0eC5maWxsUmVjdCgwLCAwLCBjYW52YXMud2lkdGgsIGNhbnZhcy5oZWlnaHQpCiAgICAgICAgICAKICAgICAgICAgIC8vIOe7mOWItuS6jOe7tOeggeaooeWdlwogICAgICAgICAgZm9yIChsZXQgcm93ID0gMDsgcm93IDwgcXIuZ2V0TW9kdWxlQ291bnQoKTsgcm93KyspIHsKICAgICAgICAgICAgZm9yIChsZXQgY29sID0gMDsgY29sIDwgcXIuZ2V0TW9kdWxlQ291bnQoKTsgY29sKyspIHsKICAgICAgICAgICAgICBpZiAocXIuaXNEYXJrKHJvdywgY29sKSkgewogICAgICAgICAgICAgICAgY3R4LmZpbGxTdHlsZSA9ICcjMDAwMDAwJwogICAgICAgICAgICAgICAgY3R4LmZpbGxSZWN0KGNvbCAqIGNlbGxTaXplLCByb3cgKiBjZWxsU2l6ZSwgY2VsbFNpemUsIGNlbGxTaXplKQogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgICAgCiAgICAgICAgICAvLyDlsIZjYW52YXPmt7vliqDliLDlrrnlmajkuK0KICAgICAgICAgIHRoaXMuJHJlZnMudGVzdFFSQ29kZUNhbnZhcy5hcHBlbmRDaGlsZChjYW52YXMpCiAgICAgICAgICAKICAgICAgICAgIGNvbnNvbGUubG9nKCfmtYvor5Xkuoznu7TnoIHnlJ/miJDmiJDlip8nKQogICAgICAgICAgcmVzb2x2ZSgpCiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHsKICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ+WIm+W7uua1i+ivleS6jOe7tOeggeWbvueJh+Wksei0pTonLCBlcnJvcikKICAgICAgICAgIHRoaXMuZXJyb3JNZXNzYWdlID0gJ+eUn+aIkOS6jOe7tOeggeWksei0pTogJyArIGVycm9yLm1lc3NhZ2UKICAgICAgICAgIHJlamVjdChlcnJvcikKICAgICAgICB9CiAgICAgIH0pCiAgICB9CiAgfQp9Cg=="},{"version":3,"sources":["QRCodeTest.vue"],"names":[],"mappings":";AA6BA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"QRCodeTest.vue","sourceRoot":"src/components","sourcesContent":["<template>\n  <div class=\"qrcode-test\">\n    <h2>二维码生成测试</h2>\n    \n    <div class=\"test-section\">\n      <el-button type=\"primary\" @click=\"testQRCodeGeneration\" :loading=\"loading\">\n        {{ loading ? '测试中...' : '测试二维码生成' }}\n      </el-button>\n      <el-button @click=\"testWithSampleData\">使用示例数据测试</el-button>\n    </div>\n    \n    <div v-if=\"testResult\" class=\"test-result\">\n      <h3>测试结果:</h3>\n      <pre>{{ JSON.stringify(testResult, null, 2) }}</pre>\n    </div>\n    \n    <div v-if=\"qrCodeUrl\" class=\"qrcode-display\">\n      <h3>生成的二维码:</h3>\n      <div ref=\"testQRCodeCanvas\" class=\"qrcode-canvas-wrapper\"></div>\n      <p>二维码URL: {{ qrCodeUrl }}</p>\n    </div>\n    \n    <div v-if=\"errorMessage\" class=\"error-message\">\n      <el-alert type=\"error\" :title=\"errorMessage\" show-icon></el-alert>\n    </div>\n  </div>\n</template>\n\n<script>\nimport qrcode from 'qrcode-generator'\nimport { generateQRCode } from '@/api/bilibiliAuth'\n\nexport default {\n  name: 'QRCodeTest',\n  data() {\n    return {\n      loading: false,\n      testResult: null,\n      qrCodeUrl: '',\n      errorMessage: ''\n    }\n  },\n  methods: {\n    async testQRCodeGeneration() {\n      this.loading = true\n      this.testResult = null\n      this.qrCodeUrl = ''\n      this.errorMessage = ''\n      \n      try {\n        console.log('开始测试二维码生成...')\n        const response = await generateQRCode()\n        console.log('二维码生成响应:', response)\n        \n        this.testResult = response\n        \n        if (response.code === 0) {\n          this.qrCodeUrl = response.data.url\n          console.log('二维码URL:', this.qrCodeUrl)\n          \n          // 等待DOM更新\n          await this.$nextTick()\n          console.log('DOM已更新，准备生成二维码')\n          \n          // 生成二维码\n          await this.generateTestQRCode()\n        } else {\n          this.errorMessage = 'API返回错误: ' + response.message\n        }\n      } catch (error) {\n        console.error('测试二维码生成失败:', error)\n        this.errorMessage = '测试失败: ' + error.message\n      } finally {\n        this.loading = false\n      }\n    },\n    \n    async testWithSampleData() {\n      this.testResult = {\n        code: 0,\n        message: \"success\",\n        data: {\n          url: \"https://passport.bilibili.com/h5-app/passport/login/qr?oauthKey=sample_key_123456\",\n          qrcode_key: \"sample_key_123456\"\n        }\n      }\n      \n      this.qrCodeUrl = this.testResult.data.url\n      this.errorMessage = ''\n      \n      // 等待DOM更新\n      await this.$nextTick()\n      console.log('DOM已更新，准备生成二维码')\n      \n      // 生成二维码\n      await this.generateTestQRCode()\n    },\n    \n    generateTestQRCode() {\n      return new Promise((resolve, reject) => {\n        if (!this.qrCodeUrl) {\n          const error = new Error('二维码URL为空')\n          console.warn('缺少生成二维码的必要参数: 二维码URL为空')\n          this.errorMessage = '二维码URL为空'\n          reject(error)\n          return\n        }\n        \n        if (!this.$refs.testQRCodeCanvas) {\n          const error = new Error('二维码Canvas容器未找到')\n          console.warn('缺少生成二维码的必要参数: 二维码Canvas容器未找到')\n          this.errorMessage = '二维码显示容器未找到'\n          reject(error)\n          return\n        }\n        \n        try {\n          console.log('开始使用qrcode-generator生成测试二维码:', { url: this.qrCodeUrl, canvas: this.$refs.testQRCodeCanvas })\n          \n          // 清空容器\n          this.$refs.testQRCodeCanvas.innerHTML = ''\n          \n          // 使用qrcode-generator生成二维码\n          const qr = qrcode(0, 'M')\n          qr.addData(this.qrCodeUrl)\n          qr.make()\n          \n          // 创建canvas元素\n          const canvas = document.createElement('canvas')\n          canvas.width = 300\n          canvas.height = 300\n          canvas.style.maxWidth = '100%'\n          canvas.style.maxHeight = '100%'\n          \n          // 获取canvas上下文并绘制二维码\n          const ctx = canvas.getContext('2d')\n          const cellSize = Math.floor(canvas.width / qr.getModuleCount())\n          \n          // 绘制背景\n          ctx.fillStyle = '#ffffff'\n          ctx.fillRect(0, 0, canvas.width, canvas.height)\n          \n          // 绘制二维码模块\n          for (let row = 0; row < qr.getModuleCount(); row++) {\n            for (let col = 0; col < qr.getModuleCount(); col++) {\n              if (qr.isDark(row, col)) {\n                ctx.fillStyle = '#000000'\n                ctx.fillRect(col * cellSize, row * cellSize, cellSize, cellSize)\n              }\n            }\n          }\n          \n          // 将canvas添加到容器中\n          this.$refs.testQRCodeCanvas.appendChild(canvas)\n          \n          console.log('测试二维码生成成功')\n          resolve()\n        } catch (error) {\n          console.error('创建测试二维码图片失败:', error)\n          this.errorMessage = '生成二维码失败: ' + error.message\n          reject(error)\n        }\n      })\n    }\n  }\n}\n</script>\n\n<style scoped>\n.qrcode-test {\n  padding: 20px;\n  max-width: 800px;\n  margin: 0 auto;\n}\n\n.test-section {\n  margin-bottom: 20px;\n}\n\n.test-section .el-button {\n  margin-right: 10px;\n}\n\n.test-result {\n  margin: 20px 0;\n  padding: 15px;\n  background-color: #f5f7fa;\n  border-radius: 4px;\n  border: 1px solid #ebeef5;\n}\n\n.test-result h3 {\n  margin-top: 0;\n}\n\n.test-result pre {\n  white-space: pre-wrap;\n  word-break: break-all;\n  margin: 0;\n  font-size: 12px;\n}\n\n.qrcode-display {\n  margin: 20px 0;\n  padding: 20px;\n  border: 1px solid #ebeef5;\n  border-radius: 4px;\n}\n\n.qrcode-display h3 {\n  margin-top: 0;\n}\n\n.qrcode-canvas-wrapper {\n  display: flex;\n  justify-content: center;\n  margin: 20px 0;\n  min-height: 300px;\n  align-items: center;\n  border: 1px dashed #dcdfe6;\n  border-radius: 4px;\n}\n\n.error-message {\n  margin: 20px 0;\n}\n</style>"]}]}