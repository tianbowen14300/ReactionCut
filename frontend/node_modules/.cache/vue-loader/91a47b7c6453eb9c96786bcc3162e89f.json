{"remainingRequest":"/Users/tbw/work/btProject/reaction-cut/frontend/node_modules/.pnpm/vue-loader@15.11.1_@vue+compiler-sfc@3.5.22_cache-loader@4.1.0_webpack@4.47.0__css-load_f9e102e5cbb5fa5aa7d45569a28cebe6/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/tbw/work/btProject/reaction-cut/frontend/src/components/QRCodeTest.vue?vue&type=style&index=0&id=0be10370&scoped=true&lang=css","dependencies":[{"path":"/Users/tbw/work/btProject/reaction-cut/frontend/src/components/QRCodeTest.vue","mtime":1761575496817},{"path":"/Users/tbw/work/btProject/reaction-cut/frontend/node_modules/.pnpm/css-loader@3.6.0_webpack@5.102.1/node_modules/css-loader/dist/cjs.js","mtime":1762013131130},{"path":"/Users/tbw/work/btProject/reaction-cut/frontend/node_modules/.pnpm/vue-loader@15.11.1_@vue+compiler-sfc@3.5.22_cache-loader@4.1.0_webpack@4.47.0__css-load_f9e102e5cbb5fa5aa7d45569a28cebe6/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":1761026704430},{"path":"/Users/tbw/work/btProject/reaction-cut/frontend/node_modules/.pnpm/postcss-loader@3.0.0/node_modules/postcss-loader/src/index.js","mtime":1762013131924},{"path":"/Users/tbw/work/btProject/reaction-cut/frontend/node_modules/.pnpm/cache-loader@4.1.0_webpack@4.47.0/node_modules/cache-loader/dist/cjs.js","mtime":1761026713270},{"path":"/Users/tbw/work/btProject/reaction-cut/frontend/node_modules/.pnpm/vue-loader@15.11.1_@vue+compiler-sfc@3.5.22_cache-loader@4.1.0_webpack@4.47.0__css-load_f9e102e5cbb5fa5aa7d45569a28cebe6/node_modules/vue-loader/lib/index.js","mtime":1761026704427}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ci5xcmNvZGUtdGVzdCB7CiAgcGFkZGluZzogMjBweDsKICBtYXgtd2lkdGg6IDgwMHB4OwogIG1hcmdpbjogMCBhdXRvOwp9CgoudGVzdC1zZWN0aW9uIHsKICBtYXJnaW4tYm90dG9tOiAyMHB4Owp9CgoudGVzdC1zZWN0aW9uIC5lbC1idXR0b24gewogIG1hcmdpbi1yaWdodDogMTBweDsKfQoKLnRlc3QtcmVzdWx0IHsKICBtYXJnaW46IDIwcHggMDsKICBwYWRkaW5nOiAxNXB4OwogIGJhY2tncm91bmQtY29sb3I6ICNmNWY3ZmE7CiAgYm9yZGVyLXJhZGl1czogNHB4OwogIGJvcmRlcjogMXB4IHNvbGlkICNlYmVlZjU7Cn0KCi50ZXN0LXJlc3VsdCBoMyB7CiAgbWFyZ2luLXRvcDogMDsKfQoKLnRlc3QtcmVzdWx0IHByZSB7CiAgd2hpdGUtc3BhY2U6IHByZS13cmFwOwogIHdvcmQtYnJlYWs6IGJyZWFrLWFsbDsKICBtYXJnaW46IDA7CiAgZm9udC1zaXplOiAxMnB4Owp9CgoucXJjb2RlLWRpc3BsYXkgewogIG1hcmdpbjogMjBweCAwOwogIHBhZGRpbmc6IDIwcHg7CiAgYm9yZGVyOiAxcHggc29saWQgI2ViZWVmNTsKICBib3JkZXItcmFkaXVzOiA0cHg7Cn0KCi5xcmNvZGUtZGlzcGxheSBoMyB7CiAgbWFyZ2luLXRvcDogMDsKfQoKLnFyY29kZS1jYW52YXMtd3JhcHBlciB7CiAgZGlzcGxheTogZmxleDsKICBqdXN0aWZ5LWNvbnRlbnQ6IGNlbnRlcjsKICBtYXJnaW46IDIwcHggMDsKICBtaW4taGVpZ2h0OiAzMDBweDsKICBhbGlnbi1pdGVtczogY2VudGVyOwogIGJvcmRlcjogMXB4IGRhc2hlZCAjZGNkZmU2OwogIGJvcmRlci1yYWRpdXM6IDRweDsKfQoKLmVycm9yLW1lc3NhZ2UgewogIG1hcmdpbjogMjBweCAwOwp9Cg=="},{"version":3,"sources":["QRCodeTest.vue"],"names":[],"mappings":";AAyKA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA","file":"QRCodeTest.vue","sourceRoot":"src/components","sourcesContent":["<template>\n  <div class=\"qrcode-test\">\n    <h2>二维码生成测试</h2>\n    \n    <div class=\"test-section\">\n      <el-button type=\"primary\" @click=\"testQRCodeGeneration\" :loading=\"loading\">\n        {{ loading ? '测试中...' : '测试二维码生成' }}\n      </el-button>\n      <el-button @click=\"testWithSampleData\">使用示例数据测试</el-button>\n    </div>\n    \n    <div v-if=\"testResult\" class=\"test-result\">\n      <h3>测试结果:</h3>\n      <pre>{{ JSON.stringify(testResult, null, 2) }}</pre>\n    </div>\n    \n    <div v-if=\"qrCodeUrl\" class=\"qrcode-display\">\n      <h3>生成的二维码:</h3>\n      <div ref=\"testQRCodeCanvas\" class=\"qrcode-canvas-wrapper\"></div>\n      <p>二维码URL: {{ qrCodeUrl }}</p>\n    </div>\n    \n    <div v-if=\"errorMessage\" class=\"error-message\">\n      <el-alert type=\"error\" :title=\"errorMessage\" show-icon></el-alert>\n    </div>\n  </div>\n</template>\n\n<script>\nimport qrcode from 'qrcode-generator'\nimport { generateQRCode } from '@/api/bilibiliAuth'\n\nexport default {\n  name: 'QRCodeTest',\n  data() {\n    return {\n      loading: false,\n      testResult: null,\n      qrCodeUrl: '',\n      errorMessage: ''\n    }\n  },\n  methods: {\n    async testQRCodeGeneration() {\n      this.loading = true\n      this.testResult = null\n      this.qrCodeUrl = ''\n      this.errorMessage = ''\n      \n      try {\n        console.log('开始测试二维码生成...')\n        const response = await generateQRCode()\n        console.log('二维码生成响应:', response)\n        \n        this.testResult = response\n        \n        if (response.code === 0) {\n          this.qrCodeUrl = response.data.url\n          console.log('二维码URL:', this.qrCodeUrl)\n          \n          // 等待DOM更新\n          await this.$nextTick()\n          console.log('DOM已更新，准备生成二维码')\n          \n          // 生成二维码\n          await this.generateTestQRCode()\n        } else {\n          this.errorMessage = 'API返回错误: ' + response.message\n        }\n      } catch (error) {\n        console.error('测试二维码生成失败:', error)\n        this.errorMessage = '测试失败: ' + error.message\n      } finally {\n        this.loading = false\n      }\n    },\n    \n    async testWithSampleData() {\n      this.testResult = {\n        code: 0,\n        message: \"success\",\n        data: {\n          url: \"https://passport.bilibili.com/h5-app/passport/login/qr?oauthKey=sample_key_123456\",\n          qrcode_key: \"sample_key_123456\"\n        }\n      }\n      \n      this.qrCodeUrl = this.testResult.data.url\n      this.errorMessage = ''\n      \n      // 等待DOM更新\n      await this.$nextTick()\n      console.log('DOM已更新，准备生成二维码')\n      \n      // 生成二维码\n      await this.generateTestQRCode()\n    },\n    \n    generateTestQRCode() {\n      return new Promise((resolve, reject) => {\n        if (!this.qrCodeUrl) {\n          const error = new Error('二维码URL为空')\n          console.warn('缺少生成二维码的必要参数: 二维码URL为空')\n          this.errorMessage = '二维码URL为空'\n          reject(error)\n          return\n        }\n        \n        if (!this.$refs.testQRCodeCanvas) {\n          const error = new Error('二维码Canvas容器未找到')\n          console.warn('缺少生成二维码的必要参数: 二维码Canvas容器未找到')\n          this.errorMessage = '二维码显示容器未找到'\n          reject(error)\n          return\n        }\n        \n        try {\n          console.log('开始使用qrcode-generator生成测试二维码:', { url: this.qrCodeUrl, canvas: this.$refs.testQRCodeCanvas })\n          \n          // 清空容器\n          this.$refs.testQRCodeCanvas.innerHTML = ''\n          \n          // 使用qrcode-generator生成二维码\n          const qr = qrcode(0, 'M')\n          qr.addData(this.qrCodeUrl)\n          qr.make()\n          \n          // 创建canvas元素\n          const canvas = document.createElement('canvas')\n          canvas.width = 300\n          canvas.height = 300\n          canvas.style.maxWidth = '100%'\n          canvas.style.maxHeight = '100%'\n          \n          // 获取canvas上下文并绘制二维码\n          const ctx = canvas.getContext('2d')\n          const cellSize = Math.floor(canvas.width / qr.getModuleCount())\n          \n          // 绘制背景\n          ctx.fillStyle = '#ffffff'\n          ctx.fillRect(0, 0, canvas.width, canvas.height)\n          \n          // 绘制二维码模块\n          for (let row = 0; row < qr.getModuleCount(); row++) {\n            for (let col = 0; col < qr.getModuleCount(); col++) {\n              if (qr.isDark(row, col)) {\n                ctx.fillStyle = '#000000'\n                ctx.fillRect(col * cellSize, row * cellSize, cellSize, cellSize)\n              }\n            }\n          }\n          \n          // 将canvas添加到容器中\n          this.$refs.testQRCodeCanvas.appendChild(canvas)\n          \n          console.log('测试二维码生成成功')\n          resolve()\n        } catch (error) {\n          console.error('创建测试二维码图片失败:', error)\n          this.errorMessage = '生成二维码失败: ' + error.message\n          reject(error)\n        }\n      })\n    }\n  }\n}\n</script>\n\n<style scoped>\n.qrcode-test {\n  padding: 20px;\n  max-width: 800px;\n  margin: 0 auto;\n}\n\n.test-section {\n  margin-bottom: 20px;\n}\n\n.test-section .el-button {\n  margin-right: 10px;\n}\n\n.test-result {\n  margin: 20px 0;\n  padding: 15px;\n  background-color: #f5f7fa;\n  border-radius: 4px;\n  border: 1px solid #ebeef5;\n}\n\n.test-result h3 {\n  margin-top: 0;\n}\n\n.test-result pre {\n  white-space: pre-wrap;\n  word-break: break-all;\n  margin: 0;\n  font-size: 12px;\n}\n\n.qrcode-display {\n  margin: 20px 0;\n  padding: 20px;\n  border: 1px solid #ebeef5;\n  border-radius: 4px;\n}\n\n.qrcode-display h3 {\n  margin-top: 0;\n}\n\n.qrcode-canvas-wrapper {\n  display: flex;\n  justify-content: center;\n  margin: 20px 0;\n  min-height: 300px;\n  align-items: center;\n  border: 1px dashed #dcdfe6;\n  border-radius: 4px;\n}\n\n.error-message {\n  margin: 20px 0;\n}\n</style>"]}]}